global:
  ## Global Docker image parameters
  ## Please, note that this will override the image parameters, including dependencies, configured to use the global value
  ## @param global.imageRegistry Global Docker Image registry
  ## @param global.imagePullSecrets Global Docker registry secret names as an array
  ##
  imageRegistry: {{(coalesce .Values.container.conversations_backend.registry .Values.container.default.registry) | quote }}
  imagePullSecrets:
    - name: {{ (coalesce .Values.container.conversations_backend.imagePullSecret .Values.container.default.imagePullSecret) | quote }}
  ## @param global.defaultStorageClass Global default StorageClass for Persistent Volume(s)
  ##
  defaultStorageClass: {{ .Values.pvc.default.storageClass | quote }}


clusterDomain: {{ .Values.cluster.networking.domain | default "cluster.local" | quote }}

conversations:
  image:
    registry: {{(coalesce .Values.container.conversations_backend.registry .Values.container.default.registry) | quote }}
    repository: {{ .Values.container.conversations_backend.repository | quote }}
    tag: {{ .Values.container.conversations_backend.tag | quote }}

  resourcesPreset: {{ .Values.global.resourcesPreset | quote }}
  resources: {{ .Values.resource.conversations.conversationsBackend | toYaml | nindent 4 }}
  podSecurityContext: {{ .Values.security.default.podSecurityContext | toYaml | nindent 4 }}
  containerSecurityContext:  {{ .Values.security.default.containerSecurityContext | toYaml | nindent 4 }}
  autoscaling:
    hpa: {{ .Values.autoscaling.horizontal.conversations | toYaml | nindent 6 }}

  runtimeClassName: {{ .Values.cluster.runtimeClassName | quote }}

  secretKey: {{ .Values.application.conversations.secretKey | quote }}

  CSRFTrustedOrigins: "https://{{ .Values.global.hostname.conversations }}.{{ .Values.global.domain }},http://{{ .Values.global.hostname.conversations }}.{{ .Values.global.domain }}"
  CORSAllowedOrigins: "https://{{ .Values.global.hostname.conversations }}.{{ .Values.global.domain }},http://{{ .Values.global.hostname.conversations }}.{{ .Values.global.domain }}"
  AllowedHosts: "{{ .Values.global.hostname.conversations }}.{{ .Values.global.domain }}"
  baseUrl: "https://{{ .Values.global.hostname.conversations }}.{{ .Values.global.domain }}"

  superuserEmail: {{  .Values.secret.conversations.adminUser | quote }}
  superuserPassword: {{  .Values.secret.conversations.adminPassword | quote }}

conversations_frontend:
  image:
    registry: {{(coalesce .Values.container.conversations_frontend.registry .Values.container.default.registry) | quote }}
    repository: {{ .Values.container.conversations_frontend.repository | quote }}
    tag: {{ .Values.container.conversations_frontend.tag | quote }}

  resourcesPreset: {{ .Values.global.resourcesPreset | quote }}
  resources: {{ .Values.resource.conversations.conversationsFrontend | toYaml | nindent 4 }}
  podSecurityContext: {{ .Values.security.default.podSecurityContext | toYaml | nindent 4 }}
  containerSecurityContext:  {{ .Values.security.default.containerSecurityContext | toYaml | nindent 4 }}
  autoscaling:
    hpa: {{ .Values.autoscaling.horizontal.conversations | toYaml | nindent 6 }}

  runtimeClassName: {{ .Values.cluster.runtimeClassName | quote }}

ingress:
  ## @param ingress.enabled Enable ingress record generation for conversations
  ##
  enabled: true
  hostname: {{ .Values.global.hostname.conversations }}.{{ .Values.global.domain }}
  extraTls: {{ .Values.tls.conversations | toYaml | nindent 4 }}
  ingressClassName: {{ .Values.cluster.ingress.className | quote }}
  annotations:
    {{- if .Values.cluster.ingress.annotations }}
    {{ .Values.cluster.ingress.annotations | toYaml | nindent 4 }}
    {{- end }}
    {{- if eq .Values.cluster.ingress.type "nginx" }}
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
    nginx.ingress.kubernetes.io/configuration-snippet: |
      add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
    {{- end }}
    {{- if eq .Values.cluster.ingress.type "haproxy-openshift" }}
    haproxy.router.openshift.io/hsts_header: max-age=31536000;includeSubDomains;preload
    {{- end }}


externalRedis:
  host: {{ .Values.cache.conversations.host | quote }}
  port: {{ .Values.cache.conversations.port | quote }}
  password: {{ .Values.cache.conversations.password | quote }}

externalDatabase:
  database: {{ .Values.database.conversations.name | quote }}
  username: {{ .Values.database.conversations.user | quote }}
  host: {{ .Values.database.conversations.host | quote }}
  password: {{ .Values.database.conversations.password | quote }}
  port: {{ .Values.database.conversations.port | quote }}
  type: {{ .Values.database.conversations.type | quote }}
  logging: true


authentication:
  issuer: {{ .Values.authentication.oidc.issuer | quote }}
  authorization_endpoint: {{ .Values.authentication.oidc.authorization_endpoint | quote }}
  token_endpoint: {{ .Values.authentication.oidc.token_endpoint | quote }}
  introspection_endpoint: {{ .Values.authentication.oidc.introspection_endpoint | quote }}
  userinfo_endpoint: {{ .Values.authentication.oidc.userinfo_endpoint | quote }}
  end_session_endpoint: {{ .Values.authentication.oidc.end_session_endpoint | quote }}
  jwks_uri: {{ .Values.authentication.oidc.jwks_uri | quote }}
  claims:
    username: {{ .Values.authentication.oidc.claims.username | quote }}
    display_name: {{ .Values.authentication.oidc.claims.display_name | quote }}
    given_name: {{ .Values.authentication.oidc.claims.given_name | quote }}
    family_name: {{ .Values.authentication.oidc.claims.family_name | quote }}

  client:
    client_id: {{ .Values.authentication.client.conversations.client_id | quote }}
    client_secret: {{ .Values.authentication.client.conversations.client_secret | quote }}


ai:
  model: {{ .Values.ai.llm.model | quote }}
  endpoint: {{ .Values.ai.llm.endpoint | quote }}
  apiKey: {{ .Values.ai.llm.apiKey | quote }}
